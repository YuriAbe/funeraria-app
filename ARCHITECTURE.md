# üèóÔ∏è Arquitetura do Projeto - Funer√°ria App

## üìã Vis√£o Geral

Este √© um aplicativo React Native desenvolvido com Expo para gerenciamento de servi√ßos funer√°rios. O projeto utiliza TypeScript para tipagem est√°tica e Firebase para autentica√ß√£o.

## üéØ Objetivo do Projeto

Aplicativo mobile para gerenciar:
- Cadastro e autentica√ß√£o de usu√°rios
- Cat√°logo de caix√µes e produtos funer√°rios
- Contratos de servi√ßos
- Terrenos e jazigos
- Decora√ß√µes e l√°pides personalizadas
- Perfil de usu√°rio

## üóÇÔ∏è Estrutura de Pastas

```
funeraria-app/
‚îú‚îÄ‚îÄ assets/                      # Recursos est√°ticos (imagens, logos)
‚îÇ   ‚îî‚îÄ‚îÄ logosemfundo.png        # Logo da funer√°ria
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ screens/                # Telas da aplica√ß√£o
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ HomeScreen.tsx      # Tela inicial (landing page)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LoginScreen.tsx     # Tela de login
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CadastroScreen.tsx  # Tela de cadastro de usu√°rio
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MainScreen.tsx      # Dashboard principal
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProfileScreen.tsx   # Perfil do usu√°rio
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CaixaoListScreen.tsx       # Lista de caix√µes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CaixaoFormScreen.tsx       # Formul√°rio de caix√£o
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ContratoListScreen.tsx     # Lista de contratos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ContratoFormScreen.tsx     # Formul√°rio de contrato
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TerrenoListScreen.tsx      # Lista de terrenos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TerrenoFormScreen.tsx      # Formul√°rio de terreno
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ JazigoListScreen.tsx       # Lista de jazigos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ JazigoFormScreen.tsx       # Formul√°rio de jazigo
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DecoracaoListScreen.tsx    # Lista de decora√ß√µes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DecoracaoFormScreen.tsx    # Formul√°rio de decora√ß√£o
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LapideListScreen.tsx       # Lista de l√°pides
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ LapideFormScreen.tsx       # Formul√°rio de l√°pide
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ       ‚îî‚îÄ‚îÄ connectionFirebase.tsx     # Configura√ß√£o do Firebase
‚îÇ
‚îú‚îÄ‚îÄ App.tsx                     # Componente raiz com navega√ß√£o
‚îú‚îÄ‚îÄ index.ts                    # Entry point da aplica√ß√£o
‚îú‚îÄ‚îÄ package.json                # Depend√™ncias do projeto
‚îú‚îÄ‚îÄ tsconfig.json               # Configura√ß√£o TypeScript
‚îî‚îÄ‚îÄ app.json                    # Configura√ß√£o do Expo

```

## üîß Stack Tecnol√≥gica

### Core
- **React Native** 0.79.6 - Framework mobile
- **React** 19.0.0 - Biblioteca UI
- **TypeScript** 5.8.3 - Tipagem est√°tica
- **Expo** ~53.0.22 - Plataforma de desenvolvimento

### Navega√ß√£o
- **@react-navigation/native** 6.1.18 - Navega√ß√£o entre telas
- **@react-navigation/stack** 6.4.1 - Stack navigator

### Backend & Armazenamento
- **Firebase** 12.2.1 - Backend as a Service
  - Firebase Authentication (email/senha)
  - Firebase Realtime Database (futuro)
- **AsyncStorage** 1.24.0 - Armazenamento local (dados offline)

### Utilit√°rios
- **react-native-gesture-handler** 2.20.2 - Gestos e intera√ß√µes
- **react-native-reanimated** 3.16.1 - Anima√ß√µes
- **react-native-safe-area-context** 4.14.1 - Safe areas
- **react-native-screens** 4.15.4 - Otimiza√ß√£o de telas

## üîê Autentica√ß√£o

### Firebase Authentication

O projeto utiliza Firebase Authentication com m√©todo de email/senha:

```typescript
// src/services/connectionFirebase.tsx
import { getAuth } from 'firebase/auth';
export const auth = getAuth(app);
```

### Fluxo de Autentica√ß√£o

1. **Cadastro** (`CadastroScreen.tsx`)
   - Valida√ß√£o de email e senha
   - Cria√ß√£o de usu√°rio no Firebase
   - Navega√ß√£o autom√°tica para tela principal

2. **Login** (`LoginScreen.tsx`)
   - Autentica√ß√£o com email/senha
   - Valida√ß√£o de credenciais
   - Redirecionamento para MainScreen

3. **Perfil** (`ProfileScreen.tsx`)
   - Edi√ß√£o de dados pessoais (nome, email, cidade, telefone, data nascimento)
   - Altera√ß√£o de senha (com reautentica√ß√£o)
   - Exclus√£o de conta (com confirma√ß√£o)
   - Dados salvos localmente com AsyncStorage

## üíæ Armazenamento de Dados

### AsyncStorage

Atualmente, todos os dados CRUD s√£o armazenados localmente usando AsyncStorage:

```typescript
// Exemplo de armazenamento
await AsyncStorage.setItem('caixoes', JSON.stringify(caixoes));

// Exemplo de leitura
const stored = await AsyncStorage.getItem('caixoes');
const data = stored ? JSON.parse(stored) : [];
```

### Estrutura de Dados

Cada entidade segue um padr√£o similar:

```typescript
interface Entity {
  id: string;              // Timestamp √∫nico
  // campos espec√≠ficos da entidade
  createdAt: string;       // ISO date string
}
```

**Chaves AsyncStorage:**
- `caixoes` - Cat√°logo de caix√µes
- `contratos` - Contratos de servi√ßos
- `terrenos` - Terrenos para sepultamento
- `jazigos` - Jazigos familiares
- `decoracoes` - Decora√ß√µes de cemit√©rio
- `lapides` - L√°pides personalizadas
- `profile_{userId}` - Dados de perfil do usu√°rio

## üß≠ Navega√ß√£o

### Stack Navigator

Todas as telas s√£o gerenciadas por um Stack Navigator:

```typescript
type RootStackParamList = {
  Home: undefined;
  Login: undefined;
  Cadastro: undefined;
  Main: undefined;
  Profile: undefined;
  CaixaoList: undefined;
  CaixaoForm: { caixao?: Caixao };
  // ... outras rotas
};
```

### Fluxo de Navega√ß√£o

```
HomeScreen (Landing)
  ‚îú‚îÄ‚îÄ LoginScreen
  ‚îÇ   ‚îî‚îÄ‚îÄ MainScreen (Dashboard)
  ‚îÇ       ‚îú‚îÄ‚îÄ ProfileScreen
  ‚îÇ       ‚îú‚îÄ‚îÄ CaixaoListScreen ‚Üí CaixaoFormScreen
  ‚îÇ       ‚îú‚îÄ‚îÄ ContratoListScreen ‚Üí ContratoFormScreen
  ‚îÇ       ‚îú‚îÄ‚îÄ TerrenoListScreen ‚Üí TerrenoFormScreen
  ‚îÇ       ‚îú‚îÄ‚îÄ JazigoListScreen ‚Üí JazigoFormScreen
  ‚îÇ       ‚îú‚îÄ‚îÄ DecoracaoListScreen ‚Üí DecoracaoFormScreen
  ‚îÇ       ‚îî‚îÄ‚îÄ LapideListScreen ‚Üí LapideFormScreen
  ‚îÇ
  ‚îî‚îÄ‚îÄ CadastroScreen ‚Üí MainScreen
```

## üé® Padr√µes de Design

### Cores do Tema

```typescript
const COLORS = {
  primary: '#3a4774',      // Azul escuro (bot√µes principais)
  secondary: '#2c3e50',    // Cinza escuro (headers, t√≠tulos)
  success: '#27ae60',      // Verde (pre√ßos, sucesso)
  danger: '#e74c3c',       // Vermelho (deletar, erros)
  warning: '#DAA520',      // Dourado (avisos)
  info: '#3498db',         // Azul claro (editar, info)
  background: '#f8f9fa',   // Cinza claro (fundo)
  white: '#ffffff',        // Branco (cards)
  text: '#2c3e50',         // Texto principal
  textSecondary: '#7f8c8d', // Texto secund√°rio
  border: '#e9ecef',       // Bordas
};
```

### Cores por Servi√ßo

Cada servi√ßo tem uma cor identificadora:

- **Contratos de Caix√£o**: `#8B4513` (Marrom)
- **Cat√°logo de Caix√µes**: `#654321` (Marrom escuro)
- **Terrenos**: `#228B22` (Verde floresta)
- **Jazigos**: `#696969` (Cinza)
- **Decora√ß√µes**: `#FF69B4` (Rosa)
- **L√°pides**: `#A9A9A9` (Cinza claro)

## üì± Padr√µes de Telas

### Telas de Lista (List Screens)

Todas seguem o mesmo padr√£o:

1. **Header** com t√≠tulo e bot√£o "Novo"
2. **FlatList** com cards
3. **Empty State** quando n√£o h√° dados
4. **Bot√µes de a√ß√£o** (Editar/Deletar) em cada card
5. **useFocusEffect** para recarregar ao entrar na tela

### Telas de Formul√°rio (Form Screens)

Padr√£o consistente:

1. **KeyboardAvoidingView** para iOS
2. **ScrollView** para campos longos
3. **Valida√ß√£o** de campos obrigat√≥rios
4. **M√°scaras** para campos especiais (pre√ßo, telefone, data)
5. **Bot√µes** Cancelar e Salvar
6. **Mensagens de erro** inline

## üîÑ Estado e Lifecycle

### Hooks Utilizados

- `useState` - Estado local de componentes
- `useEffect` - Side effects (carregar dados)
- `useNavigation` - Navega√ß√£o program√°tica
- `useRoute` - Par√¢metros de rota
- `useFocusEffect` - Executar ao focar na tela

### Carregamento de Dados

```typescript
useFocusEffect(
  React.useCallback(() => {
    loadData();
  }, [])
);
```

## üöÄ Funcionalidades Implementadas

### ‚úÖ Autentica√ß√£o
- [x] Cadastro de usu√°rio
- [x] Login com email/senha
- [x] Logout
- [x] Edi√ß√£o de perfil
- [x] Altera√ß√£o de senha
- [x] Exclus√£o de conta

### ‚úÖ CRUD Completo
- [x] Caix√µes (Create, Read, Update, Delete)
- [x] Contratos (Create, Read, Update, Delete)
- [x] Terrenos (Create, Read, Update, Delete)
- [x] Jazigos (Create, Read, Update, Delete)
- [x] Decora√ß√µes (Create, Read, Update, Delete)
- [x] L√°pides (Create, Read, Update, Delete)

### ‚úÖ UX/UI
- [x] Navega√ß√£o fluida
- [x] Anima√ß√µes suaves
- [x] Feedback visual
- [x] Estados vazios informativos
- [x] Confirma√ß√µes de a√ß√µes destrutivas

## üîÆ Pr√≥ximos Passos

### Backend
- [ ] Migrar AsyncStorage para Firebase Realtime Database
- [ ] Implementar Cloud Firestore para dados estruturados
- [ ] Adicionar Firebase Storage para imagens
- [ ] Implementar valida√ß√£o server-side

### Funcionalidades
- [ ] Upload de fotos de produtos
- [ ] Sistema de carrinho de compras
- [ ] Hist√≥rico de pedidos
- [ ] Notifica√ß√µes push
- [ ] Compartilhamento de cat√°logo
- [ ] Modo offline com sincroniza√ß√£o

### UX/UI
- [ ] Dark mode
- [ ] Anima√ß√µes avan√ßadas
- [ ] Onboarding para novos usu√°rios
- [ ] Tutorial interativo
- [ ] Acessibilidade melhorada

### Administrativo
- [ ] Painel administrativo
- [ ] Relat√≥rios e m√©tricas
- [ ] Gerenciamento de estoque
- [ ] Sistema de permiss√µes

## üêõ Debugging

### Logs √öteis

```bash
# Ver logs do Metro bundler
npm start

# Logs do Android
npx react-native log-android

# Logs do iOS
npx react-native log-ios

# Limpar cache
npx expo start --clear
```

### Problemas Comuns

1. **Erro de depend√™ncias**: Use `--legacy-peer-deps`
2. **Metro bundler travado**: Limpe o cache
3. **AsyncStorage n√£o persiste**: Verifique permiss√µes
4. **Firebase n√£o conecta**: Valide vari√°veis de ambiente no `.env`

### Configura√ß√£o de Ambiente

O projeto usa vari√°veis de ambiente para configura√ß√µes sens√≠veis:

```bash
# 1. Copie o template
cp .env.example .env

# 2. Configure suas credenciais Firebase no .env
EXPO_PUBLIC_FIREBASE_API_KEY=sua_api_key
EXPO_PUBLIC_FIREBASE_AUTH_DOMAIN=seu_projeto.firebaseapp.com
# ... outras vari√°veis
```

**‚ö†Ô∏è Importante**: Nunca commite o arquivo `.env` com credenciais reais!

## üìù Conven√ß√µes de C√≥digo

### Nomenclatura
- **Componentes**: PascalCase (`CaixaoListScreen`)
- **Fun√ß√µes**: camelCase (`loadCaixoes`)
- **Constantes**: UPPER_SNAKE_CASE (`API_KEY`)
- **Interfaces**: PascalCase com prefixo I opcional (`Caixao`)

### Estrutura de Componente

```typescript
// 1. Imports
import React, { useState } from 'react';
import { View, Text } from 'react-native';

// 2. Types
type Props = { ... };
interface Data { ... }

// 3. Component
export default function ComponentName() {
  // 3.1. Hooks
  const [state, setState] = useState();
  
  // 3.2. Handlers
  const handleAction = () => { ... };
  
  // 3.3. Effects
  useEffect(() => { ... }, []);
  
  // 3.4. Render
  return ( ... );
}

// 4. Styles
const styles = StyleSheet.create({ ... });
```

## üîí Seguran√ßa

### Boas Pr√°ticas Implementadas

- ‚úÖ Vari√°veis de ambiente para Firebase config
- ‚úÖ Reautentica√ß√£o para a√ß√µes sens√≠veis
- ‚úÖ Valida√ß√£o de inputs
- ‚úÖ Sanitiza√ß√£o de dados
- ‚úÖ Confirma√ß√£o para a√ß√µes destrutivas

### Pend√™ncias de Seguran√ßa

- [ ] Implementar rate limiting
- [ ] Adicionar CAPTCHA no cadastro
- [ ] Criptografia de dados sens√≠veis
- [ ] Auditoria de logs
- [ ] Implementar 2FA

## üìö Refer√™ncias

- [React Native Docs](https://reactnative.dev/)
- [Expo Docs](https://docs.expo.dev/)
- [Firebase Docs](https://firebase.google.com/docs)
- [React Navigation](https://reactnavigation.org/)
- [TypeScript Docs](https://www.typescriptlang.org/)

---

**√öltima atualiza√ß√£o**: Outubro 2025
**Vers√£o**: 1.0.0
**Mantido por**: YuriAbe e equipe
